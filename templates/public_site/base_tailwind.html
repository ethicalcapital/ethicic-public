<!DOCTYPE html>
<!-- Template: base_tailwind.html with theme toggle - deployed at 2025-01-27 -->
<html lang="en" data-theme="{{ current_theme|default:'light' }}">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            {% block title %}{{ page_title|default:"Ethical Capital" }}{% endblock %}
        </title>
        {% load static wagtailsettings_tags menu_tags %}
        {% get_settings "public_site.SiteConfiguration" as site_config %}
        <!-- Optimized font loading strategy -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap"
              rel="stylesheet" />
        <!-- Tailwind CSS with Ethical Capital Design System -->
        <link rel="stylesheet" href="{% static 'css/dist/tailwind.min.css' %}?v=2" />
        <!-- Enhanced Typography using Tailwind CSS -->
        <style>
      .prose {
        @apply max-w-none text-lg leading-relaxed font-normal tracking-tight text-slate-300;
        font-family:
          "Inter",
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          Roboto,
          sans-serif;
      }

      .prose > * + * {
        @apply mt-7;
      }

      /* Brand-Aligned Headers */
      .prose h1,
      .prose h2,
      .prose h3,
      .prose h4,
      .prose h5,
      .prose h6 {
        @apply scroll-mt-8 font-sans leading-tight font-bold tracking-tighter text-slate-900 dark:text-slate-100;
      }

      .prose h1 {
        @apply mt-0 mb-4 text-4xl;
        background: linear-gradient(to right, theme('colors.teal.400'), theme('colors.purple.600'));
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        color: transparent;
        /* Fallback for browsers that don't support background-clip: text */
        background-clip: border-box;
        color: theme('colors.teal.400');
      }
      
      /* Modern browsers with background-clip support */
      @supports (-webkit-background-clip: text) or (background-clip: text) {
        .prose h1 {
          background-clip: text;
          -webkit-background-clip: text;
          color: transparent;
          -webkit-text-fill-color: transparent;
        }
      }

      .prose h2 {
        @apply relative mt-10 mb-3 pb-2 text-3xl;
      }

      .prose h2::after {
        @apply absolute bottom-0 left-0 h-1 w-12 rounded-full;
        content: "";
        background: linear-gradient(to right, theme('colors.teal.400'), theme('colors.purple.600'));
        /* Fallback for older browsers */
        background-color: theme('colors.teal.400');
      }

      .prose h3 {
        @apply mt-8 mb-2 text-2xl text-purple-900 dark:text-teal-400;
      }

      .prose h4 {
        @apply mt-7 mb-2 text-xl font-semibold;
      }

      /* Enhanced Text Elements */
      .prose p {
        @apply mb-6 text-justify;
        /* Cross-browser hyphenation support */
        -webkit-hyphens: auto;
        -moz-hyphens: auto;
        -ms-hyphens: auto;
        hyphens: auto;
        /* Fallback for browsers without hyphenation support */
        word-break: break-word;
        overflow-wrap: break-word;
      }

      .prose p:first-of-type {
        @apply text-xl leading-relaxed font-medium text-slate-200;
      }

      .prose a {
        @apply border-b-2 border-teal-600 font-medium text-teal-400 no-underline transition-all duration-300;
        /* Enhanced hover effects with fallbacks */
        text-decoration: none;
        border-bottom: 2px solid theme('colors.teal.600');
      }
      
      .prose a:hover {
        @apply border-teal-400 text-teal-300;
        border-radius: 4px;
        background-color: rgba(6, 95, 70, 0.2); /* Fallback for bg-teal-900/20 */
        background-color: theme('colors.teal.900' / 0.2);
        margin-left: -0.25rem;
        margin-right: -0.25rem;
        padding-left: 0.25rem;
        padding-right: 0.25rem;
      }

      .prose strong {
        @apply px-1 font-semibold text-slate-900 dark:text-slate-100;
        border-radius: 4px;
        /* Cross-browser gradient support with fallbacks */
        background-color: theme('colors.purple.50'); /* Fallback */
        background-image: linear-gradient(to right, theme('colors.purple.50'), theme('colors.teal.50'));
      }
      
      @media (prefers-color-scheme: dark) {
        .prose strong {
          background-color: rgba(88, 28, 135, 0.2); /* Fallback for dark mode */
          background-image: linear-gradient(to right, rgba(88, 28, 135, 0.2), rgba(6, 95, 70, 0.2));
        }
      }

      .prose em {
        @apply text-slate-600 italic dark:text-slate-400;
      }

      /* Beautiful Blockquotes */
      .prose blockquote {
        @apply relative my-10 rounded-xl border-none bg-gradient-to-r from-teal-50/80 to-purple-50/60 p-8 text-lg leading-relaxed text-slate-600 italic shadow-lg shadow-teal-200/50 dark:from-teal-900/20 dark:to-purple-900/20 dark:text-slate-300 dark:shadow-teal-900/20;
      }

      .prose blockquote::before {
        @apply absolute -top-2 left-5 text-6xl leading-none text-teal-300 dark:text-teal-600;
        content: '"';
        font-family: Georgia, serif;
      }

      /* Lists */
      .prose ul,
      .prose ol {
        @apply my-8 pl-0;
      }

      .prose ul li,
      .prose ol li {
        @apply relative my-4 pl-8 leading-relaxed;
      }

      .prose ul li::before {
        @apply absolute top-3 left-0 h-1.5 w-1.5 rounded-full bg-gradient-to-r from-teal-400 to-purple-600;
        content: "";
      }

      .prose ol {
        counter-reset: item;
      }

      .prose ol li::before {
        @apply absolute top-0 left-0 flex h-6 w-6 items-center justify-center rounded-full bg-gradient-to-r from-teal-400 to-purple-600 text-sm font-semibold text-white;
        content: counter(item);
        counter-increment: item;
      }

      /* Code */
      .prose code {
        @apply border border-teal-200 bg-gradient-to-r from-teal-50 to-purple-50 px-2 py-1 text-sm text-purple-900 dark:border-teal-700 dark:from-teal-900/30 dark:to-purple-900/30 dark:text-teal-400;
        border-radius: 4px;
        font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Monaco, Consolas, monospace;
      }

      .prose pre {
        @apply my-10 overflow-x-auto rounded-xl border border-teal-200/20 bg-gradient-to-r from-slate-800 to-slate-900 p-8 text-sm leading-relaxed text-slate-200 shadow-2xl;
      }

      .prose pre code {
        @apply border-none bg-transparent p-0 text-sm text-inherit;
      }

      /* Images & Tables */
      .prose img {
        @apply my-10 rounded-xl shadow-xl transition-transform duration-300 hover:-translate-y-1 hover:shadow-2xl;
      }

      .prose table {
        @apply my-10 w-full border-separate border-spacing-0 overflow-hidden rounded-xl border border-teal-200/20 bg-white shadow-lg dark:bg-slate-800;
      }

      .prose th,
      .prose td {
        @apply border-b border-teal-200/20 px-5 py-4 text-left;
      }

      .prose th {
        @apply bg-gradient-to-r from-teal-50 to-purple-50 text-sm font-semibold tracking-wider text-slate-900 uppercase dark:from-teal-900/30 dark:to-purple-900/30 dark:text-slate-100;
      }

      .prose tbody tr:hover {
        @apply bg-teal-50/50 dark:bg-teal-900/10;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .prose {
          @apply max-w-full text-base;
        }

        .prose h1 {
          @apply text-3xl;
        }
        .prose h2 {
          @apply text-2xl;
        }
        .prose h3 {
          @apply text-xl;
        }

        .prose blockquote {
          @apply my-8 p-6;
        }

        .prose pre {
          @apply my-8 p-6;
        }

        .prose ul li,
        .prose ol li {
          @apply pl-6;
        }
      }
      
      /* =========================================
         BROWSER COMPATIBILITY ENHANCEMENTS
         ========================================= */
      
      /* Flexbox fallbacks for older browsers */
      .flex {
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex;
      }
      
      .items-center {
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
      }
      
      .justify-between {
        -webkit-box-pack: justify;
        -ms-flex-pack: justify;
        justify-content: space-between;
      }
      
      /* Grid fallbacks */
      .grid {
        display: -ms-grid;
        display: grid;
      }
      
      /* Transform fallbacks */
      .transform {
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
      }
      
      /* Transition fallbacks */
      .transition-all {
        -webkit-transition: all 0.15s ease;
        -moz-transition: all 0.15s ease;
        -o-transition: all 0.15s ease;
        transition: all 0.15s ease;
      }
      
      /* Backdrop filter fallbacks */
      .backdrop-blur {
        -webkit-backdrop-filter: blur(8px);
        backdrop-filter: blur(8px);
        /* Fallback for browsers without backdrop-filter */
        background-color: rgba(0, 0, 0, 0.1);
      }
      
      /* Custom property fallbacks for critical styles */
      :root {
        --fallback-purple-900: #581c87;
        --fallback-teal-400: #2dd4bf;
        --fallback-gray-900: #111827;
      }
      
      /* Ensure form elements are properly styled across browsers */
      input, textarea, select, button {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        border-radius: 0; /* Reset iOS rounding */
      }
      
      /* Fix for mobile Safari zoom issues */
      input[type="text"],
      input[type="email"],
      input[type="number"],
      input[type="tel"],
      textarea {
        font-size: 16px; /* Prevents zoom on iOS */
      }
      
      /* Scrollbar styling for consistency */
      ::-webkit-scrollbar {
        width: 8px;
      }
      
      ::-webkit-scrollbar-track {
        background: #1f2937;
      }
      
      ::-webkit-scrollbar-thumb {
        background: #4b5563;
        border-radius: 4px;
      }
      
      ::-webkit-scrollbar-thumb:hover {
        background: #6b7280;
      }
      
      /* Firefox scrollbar styling */
      * {
        scrollbar-width: thin;
        scrollbar-color: #4b5563 #1f2937;
      }
      
      /* Smooth scrolling with fallback */
      html {
        scroll-behavior: smooth;
      }
      
      @media (prefers-reduced-motion: reduce) {
        html {
          scroll-behavior: auto;
        }
        
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
      }
      
      /* High contrast mode support */
      @media (prefers-contrast: high) {
        .prose a {
          text-decoration: underline;
          border-bottom: 2px solid currentColor;
        }
        
        .btn-ec-primary,
        .btn-ec-secondary {
          border: 2px solid currentColor;
        }
      }
        </style>
        <!-- Meta tags for SEO and social sharing -->
        <meta name="description"
              content="{% block meta_description %}{% if page %}{{ page.search_description|default:site_config.meta_description|default:'Ethical Capital provides socially responsible investment advisory services with a focus on sustainable and ethical investing.' }}{% else %}{{ site_config.meta_description|default:'Ethical Capital provides socially responsible investment advisory services with a focus on sustainable and ethical investing.' }}{% endif %}{% endblock %}" />
        <meta name="keywords"
              content="{% block meta_keywords %}{{ site_config.meta_keywords|default:'ethical investing, sustainable investing, ESG investing, socially responsible investing, investment advisory' }}{% endblock %}" />
        <!-- Open Graph tags -->
        <meta property="og:title"
              content="{% block og_title %}{% if page %}{{ page.seo_title|default:page.title|default:'Ethical Capital' }}{% else %}Ethical Capital{% endif %}{% endblock %}" />
        <meta property="og:description"
              content="{% block og_description %}{% if page %}{{ page.search_description|default:site_config.meta_description }}{% else %}{{ site_config.meta_description }}{% endif %}{% endblock %}" />
        <meta property="og:url"
              content="{% block og_url %}{{ request.build_absolute_uri }}{% endblock %}" />
        <meta property="og:type" content="{% block og_type %}website{% endblock %}" />
        <meta property="og:image"
              content="{% block og_image %}{% static 'images/og-default.svg' %}{% endblock %}" />
        <!-- Favicon -->
        <link rel="icon" type="image/svg+xml" href="{% static 'favicon.svg' %}" />
        <!-- CSRF Token for JavaScript -->
        {% csrf_token %}
        <meta name="csrf-token" content="{{ csrf_token }}" />
        <!-- HTMX for server-driven interactivity -->
        <script src="https://unpkg.com/htmx.org@1.9.11"></script>
        <!-- Alpine.js for lightweight client-side reactivity -->
        <script defer src="https://unpkg.com/alpinejs@3.14.1/dist/cdn.min.js"></script>
        {% block extra_css %}{% endblock %}
        <!-- Page width fix: 68% max-width for desktop -->
        <style>
      .container-ec {
        max-width: 68vw;
        margin: 0 auto;
        padding: 0 1rem;
      }
      @media (max-width: 768px) {
        .container-ec {
          max-width: 95vw;
        }
      }
      
      /* Footer grid override to ensure 5 columns */
      @media (min-width: 768px) {
        .footer-grid {
          grid-template-columns: repeat(5, 1fr) !important;
          display: grid !important;
        }
      }
      @media (min-width: 640px) and (max-width: 767px) {
        .footer-grid {
          grid-template-columns: repeat(2, 1fr) !important;
          display: grid !important;
        }
      }
      @media (max-width: 639px) {
        .footer-grid {
          grid-template-columns: 1fr !important;
          display: grid !important;
        }
      }
        </style>
        <!-- EMERGENCY TEXT VISIBILITY FIX - HIGHEST PRIORITY OVERRIDES -->
        <style>
            /* EMERGENCY: Nuclear-level text visibility fixes with maximum specificity */
            body * {
                color: #d1d5db !important; /* Force light gray text */
            }
            
            /* Specific overrides for content areas */
            .card-content-ec *,
            .panel-ec *,
            .space-y-4 *,
            p, div, span {
                color: #d1d5db !important; /* Light gray */
            }
            
            /* Headers remain bright */
            h1, h2, h3, h4, h5, h6 {
                color: #f3f4f6 !important; /* Brighter for headers */
            }
            
            /* Navigation and branding keep existing colors */
            header *, nav *, .btn-ec-primary *, .btn-ec-secondary * {
                color: inherit !important;
            }
            
            /* Override ANY black or dark text with light colors */
            html body *:not(.btn-ec-primary):not(.btn-ec-secondary):not(button):not(.text-white):not(header *):not(.bg-white *),
            html body .text-gray-900,
            html body .text-black,
            html body .text-slate-900,
            html body .prose,
            html body .prose *,
            html body p,
            html body div:not(.btn-ec-primary):not(.btn-ec-secondary),
            html body span,
            html body h1,
            html body h2,
            html body h3,
            html body h4,
            html body h5,
            html body h6,
            html body li,
            html body td,
            html body th,
            html body label,
            html body .card-content-ec,
            html body .card-content-ec *,
            html body .panel-content,
            html body .panel-content *,
            html body .garden-panel-content,
            html body .garden-panel-content *,
            html body section *:not(.btn-ec-primary):not(.btn-ec-secondary):not(button):not(.text-white):not(header *),
            html body main *:not(.btn-ec-primary):not(.btn-ec-secondary):not(button):not(.text-white):not(header *),
            html body article *:not(.btn-ec-primary):not(.btn-ec-secondary):not(button):not(.text-white):not(header *) {
                color: #e2e8f0 !important; /* Force light gray for all text */
            }
            
            /* Double down on strategy cards and content areas */
            html body .strategy-card *,
            html body .strategy-details *,
            html body .strategy-features *,
            html body .card-ec *,
            html body .hero-stats *:not(.text-white),
            html body .flex *:not(.btn-ec-primary):not(.btn-ec-secondary):not(.text-white) {
                color: #e2e8f0 !important;
            }
            
            /* Nuclear heading overrides */
            html body h1,
            html body h2,
            html body h3,
            html body h4,
            html body h5,
            html body h6,
            html body .text-blue-300,
            html body .text-purple-300,
            html body .text-teal-300,
            html body .panel-title-ec,
            html body .font-mono {
                color: #cbd5e1 !important; /* Bright headings */
            }
            
            /* Links must be visible */
            html body a:not(.btn-ec-primary):not(.btn-ec-secondary):not(.text-white) {
                color: #94a3b8 !important;
            }
            
            html body a:hover:not(.btn-ec-primary):not(.btn-ec-secondary):not(.text-white) {
                color: #f1f5f9 !important;
            }
            
            /* Preserve button styling but ensure visibility */
            html body .btn-ec-primary {
                color: #ffffff !important;
                background-color: #581c87 !important;
            }
            
            html body .btn-ec-secondary {
                color: #111827 !important;
                background-color: #14b8a6 !important;
            }
            
            /* White text stays white */
            html body .text-white,
            html body .text-purple-100,
            html body .text-gray-100,
            html body header *,
            html body .bg-purple-900 .text-white,
            html body .bg-gray-800 .text-white {
                color: #ffffff !important;
            }
            
            /* Ultimate override for any lingering dark text */
            html body *[style*="color: #000000"],
            html body *[style*="color: #000"],
            html body *[style*="color: black"],
            html body *[style*="color: rgb(0,0,0)"],
            html body *[style*="color: rgb(0, 0, 0)"],
            html body .text-slate-800,
            html body .text-gray-800 {
                color: #e2e8f0 !important;
            }
            
            /* Make sure everything in content areas is visible */
            html body main *,
            html body #main-content *,
            html body .container-ec * {
                /* Only apply if not already light colored */
            }
            
            html body main *:not([class*="text-white"]):not([class*="text-gray-100"]):not([class*="text-purple-100"]):not(.btn-ec-primary):not(.btn-ec-secondary),
            html body #main-content *:not([class*="text-white"]):not([class*="text-gray-100"]):not([class*="text-purple-100"]):not(.btn-ec-primary):not(.btn-ec-secondary),
            html body .container-ec *:not([class*="text-white"]):not([class*="text-gray-100"]):not([class*="text-purple-100"]):not(.btn-ec-primary):not(.btn-ec-secondary) {
                color: #e2e8f0 !important;
            }
        </style>
    </head>
    <body class="{% block body_class %}{% endblock %} block flex min-h-screen flex-col bg-gray-900 font-sans text-gray-100">
        <!-- Skip navigation links for screen readers -->
        <a href="#main-content"
           class="sr-only z-50 rounded bg-gray-900 px-4 py-2 text-white focus:not-sr-only focus:absolute focus:top-4 focus:left-4">
            Skip to main content
        </a>
        
        <!-- Site Notice -->
        <div class="bg-gray-800 border-b border-gray-600 text-center py-3 px-4">
            <div class="font-bold text-sm md:text-base text-white">
                üáµüá∏ We stand with Palestine
            </div>
            <div class="text-xs mt-1 text-gray-400 font-mono">
                (and we're remodeling our website - please pardon our "dust" while work is underway). 
                <a href="https://tidycal.com/ecic" class="text-teal-400 hover:text-teal-300 underline" target="_blank" rel="noopener noreferrer">Click here to schedule a meeting</a> 
                and 
                <a href="https://docs.google.com/forms/d/e/1FAIpQLSdx1ex4pj5iYaj1v1Yxjt7iFbicqZbKWNuOZVyMlG8sKswbgQ/viewform?usp=header" class="text-teal-400 hover:text-teal-300 underline" target="_blank" rel="noopener noreferrer">click here to become a client</a>
            </div>
        </div>
        <a href="#main-navigation"
           class="sr-only z-50 rounded bg-gray-900 px-4 py-2 text-white focus:not-sr-only focus:absolute focus:top-4 focus:left-32">
            Skip to navigation
        </a>
        <!-- ARIA live regions for announcements -->
        <div aria-live="polite"
             aria-atomic="true"
             class="sr-only"
             id="announcements"></div>
        <div aria-live="assertive"
             aria-atomic="true"
             class="sr-only"
             id="urgent-announcements"></div>
        <!-- Tailwind Navigation Header -->
        <header class="relative z-40 border-b border-purple-800 bg-purple-900 dark:border-purple-800 dark:bg-purple-900"
                role="banner"
                x-data="{ mobileMenuOpen: false }">
            <div class="container-ec">
                <div class="flex items-center justify-between py-4">
                    <!-- Left: Brand and Navigation -->
                    <div class="flex items-center space-x-8">
                        <!-- Brand -->
                        <a href="/"
                           class="font-mono text-lg font-semibold text-white transition-colors hover:text-purple-200"
                           aria-label="Ethical Capital Home">
                            {{ site_config.company_name|default:"ETHICAL CAPITAL" }}
                        </a>
                        <!-- Desktop Navigation -->
                        <nav class="hidden space-x-6 md:flex" id="main-navigation">
                            {% main_menu max_levels=1 template="wagtailmenus/main_menu_tailwind.html" %}
                        </nav>
                    </div>
                    <!-- Right: Search, Login, Mobile Menu -->
                    <div class="flex items-center space-x-2 lg:space-x-4">
                        <!-- Search -->
                        <div class="hidden lg:block"
                             x-data="{ searchOpen: false, query: '', searching: false }"
                             @htmx:before-request="searching = true"
                             @htmx:after-request="searching = false">
                            <form method="get"
                                  action="/search/"
                                  class="relative"
                                  role="search"
                                  id="search">
                                <label for="search-input" class="sr-only">Search our website</label>
                                <input type="text"
                                       id="search-input"
                                       name="q"
                                       placeholder="Search..."
                                       class="w-48 xl:w-64 rounded-lg border border-purple-700 bg-purple-800 px-4 py-2 pr-12 text-white placeholder-purple-300 focus:border-transparent focus:ring-2 focus:ring-purple-400 focus:outline-none"
                                       aria-label="Search our website"
                                       autocomplete="off"
                                       x-model="query"
                                       @focus="searchOpen = true"
                                       hx-get="/search/live/"
                                       hx-trigger="keyup changed delay:300ms"
                                       hx-target="#search-results" />
                                <button type="submit"
                                        class="absolute top-1/2 right-1 -translate-y-1/2 transform rounded bg-purple-600 px-2 py-1 text-white transition-colors hover:bg-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-400"
                                        aria-label="Submit search">
                                    <span x-show="searching" x-cloak class="animate-spin">‚ü≥</span>
                                    <span x-show="!searching">üîç</span>
                                </button>
                            </form>
                            <!-- Search results dropdown -->
                            <div id="search-results"
                                 class="absolute top-full left-0 z-50 mt-2 max-h-64 w-full overflow-y-auto rounded-lg border border-gray-600 bg-gray-800 shadow-lg"
                                 x-show="searchOpen && query.length > 0"
                                 @click.outside="searchOpen = false"
                                 x-transition
                                 x-cloak>
                                <!-- Results populated by HTMX -->
                            </div>
                        </div>
                        <!-- Login Button -->
                        <a href="https://app.altruist.com/login"
                           class="hidden md:flex items-center space-x-1 rounded-lg border border-gray-600 bg-gray-700 px-2 lg:px-3 py-2 text-white transition-colors hover:border-gray-500 hover:bg-gray-600"
                           target="_blank"
                           rel="noopener"
                           aria-label="Client login">
                            <span class="text-sm lg:text-base">Login</span>
                        </a>
                        <!-- Enhanced CTA Button -->
                        <a href="https://docs.google.com/forms/d/e/1FAIpQLSdx1ex4pj5iYaj1v1Yxjt7iFbicqZbKWNuOZVyMlG8sKswbgQ/viewform?usp=header"
                           class="btn-ec-primary transform transition-all duration-200 hover:scale-105 hover:shadow-lg text-sm lg:text-base px-3 lg:px-4 py-2 font-semibold"
                           target="_blank"
                           rel="noopener"
                           aria-label="Get started with Ethical Capital">Get Started</a>
                        <!-- Theme Toggle (temporarily hidden) -->
                        <div style="display: none;">
                            <button class="rounded-lg border border-gray-600 bg-gray-700 p-2 text-white transition-colors hover:border-gray-500 hover:bg-gray-600"
                                    x-data="{ isDark: false, init() { const currentTheme = document.documentElement.getAttribute('data-theme'); const savedTheme = localStorage.getItem('theme'); const theme = savedTheme || currentTheme || 'light'; this.isDark = theme === 'dark'; document.documentElement.setAttribute('data-theme', theme); localStorage.setItem('theme', theme); }, toggle() { this.isDark = !this.isDark; const theme = this.isDark ? 'dark' : 'light'; document.documentElement.setAttribute('data-theme', theme); localStorage.setItem('theme', theme); fetch('/api/theme/set/', { method: 'POST', headers: { 'Content-Type': 'application/json', 'X-CSRFToken': document.querySelector('[name=csrf-token]')?.content || '' }, body: JSON.stringify({ theme }) }).catch(e => console.log('Theme save failed:', e)); } }"
                                    @click="toggle()"
                                    aria-label="Toggle light/dark theme">
                                <span x-text="isDark ? 'üåô' : '‚òÄÔ∏è'" aria-hidden="true"></span>
                            </button>
                        </div>
                        <!-- Mobile menu toggle -->
                        <button class="flex flex-col space-y-1 p-2 md:hidden"
                                @click="mobileMenuOpen = true"
                                :aria-expanded="mobileMenuOpen"
                                aria-label="Open navigation menu">
                            <span class="block h-0.5 w-6 bg-white"></span>
                            <span class="block h-0.5 w-6 bg-white"></span>
                            <span class="block h-0.5 w-6 bg-white"></span>
                        </button>
                    </div>
                </div>
            </div>
            <!-- Mobile Menu Overlay -->
            <div class="bg-opacity-50 fixed inset-0 z-50 bg-black md:hidden"
                 x-show="mobileMenuOpen"
                 @click="mobileMenuOpen = false"
                 x-transition
                 x-cloak></div>
            <!-- Mobile Menu Panel -->
            <div class="fixed top-0 right-0 z-50 h-full w-80 transform border-l border-gray-600 bg-gray-800 transition-transform md:hidden"
                 x-show="mobileMenuOpen"
                 x-transition:enter="transition-transform duration-300"
                 x-transition:enter-start="translate-x-full"
                 x-transition:enter-end="translate-x-0"
                 x-transition:leave="transition-transform duration-300"
                 x-transition:leave-start="translate-x-0"
                 x-transition:leave-end="translate-x-full"
                 x-cloak>
                <!-- Mobile menu header -->
                <div class="flex items-center justify-between border-b border-gray-600 p-4">
                    <span class="font-mono text-lg text-white">Menu</span>
                    <button @click="mobileMenuOpen = false"
                            class="text-gray-400 hover:text-white">
                        <span class="sr-only">Close menu</span>
                        ‚úï
                    </button>
                </div>
                <!-- Mobile navigation -->
                <nav class="space-y-4 p-4">
                    {% main_menu max_levels=1 template="wagtailmenus/main_menu_mobile_tailwind.html" %}
                </nav>
                <!-- Mobile search -->
                <div class="border-t border-gray-600 p-4">
                    <form method="get" action="/search/" role="search" class="relative">
                        <input type="text"
                               name="q"
                               placeholder="Search..."
                               class="w-full rounded-lg border border-gray-600 bg-gray-700 px-4 py-2 pr-12 text-white placeholder-gray-400 focus:ring-2 focus:ring-purple-400 focus:outline-none"
                               aria-label="Search our website" />
                        <button type="submit"
                                class="absolute top-1/2 right-1 -translate-y-1/2 transform rounded bg-purple-600 px-2 py-1 text-white transition-colors hover:bg-purple-500 focus:outline-none focus:ring-2 focus:ring-purple-400"
                                aria-label="Submit search">
                            üîç
                        </button>
                    </form>
                </div>
                <!-- Mobile login link -->
                <div class="border-t border-gray-600 p-4">
                    <a href="https://app.altruist.com/login"
                       class="flex items-center space-x-3 rounded-lg bg-gray-700 p-3 hover:bg-gray-600"
                       target="_blank">
                        <span class="text-xl">üë§</span>
                        <div>
                            <div class="font-mono text-sm text-purple-400">Client Login</div>
                            <div class="text-xs text-gray-400">Portfolio access</div>
                        </div>
                    </a>
                </div>
            </div>
        </header>
        <!-- Main Content -->
        <main id="main-content" class="flex-1 pt-8 pb-24" role="main">
            {% block content %}{% endblock %}
        </main>
        <!-- Footer -->
        <footer class="border-t border-gray-600 bg-gray-800 mt-8" style="padding-top: 4rem !important;">
            <div class="container-ec pb-8">
                <div class="footer-grid grid grid-cols-1 gap-8 sm:grid-cols-2 md:grid-cols-5">
                    <!-- Company Info -->
                    <div>
                        <h3 class="mb-4 font-mono text-sm text-purple-400 uppercase">Ethical Capital</h3>
                        <p class="mb-4 text-sm text-gray-400">
                            Socially responsible investment advisory services with a focus on sustainable and ethical investing.
                        </p>
                        <div class="text-xs text-gray-500">
                            <p>Utah Registered Investment Adviser</p>
                            <p>CRD #316032</p>
                        </div>
                    </div>
                    <!-- Company -->
                    <div>
                        <h3 class="mb-4 font-mono text-sm text-purple-400 uppercase">Company</h3>
                        <ul class="space-y-2 text-sm">
                            <li>
                                <a href="/about/"
                                   class="text-gray-400 transition-colors hover:text-purple-400">About</a>
                            </li>
                            <li>
                                <a href="/media/"
                                   class="text-gray-400 transition-colors hover:text-purple-400">Media</a>
                            </li>
                            <li>
                                <a href="/disclosures/"
                                   class="text-gray-400 transition-colors hover:text-purple-400">Disclosures</a>
                            </li>
                            <li>
                                <a href="/accessibility/"
                                   class="text-gray-400 transition-colors hover:text-purple-400">Accessibility</a>
                            </li>
                            <li>
                                <a href="https://reports.adviserinfo.sec.gov/reports/ADV/316032/PDF/316032.pdf"
                                   class="text-gray-400 transition-colors hover:text-purple-400" target="_blank" rel="noopener noreferrer">Form ADV</a>
                            </li>
                        </ul>
                    </div>
                    <!-- Resources -->
                    <div>
                        <h3 class="mb-4 font-mono text-sm text-purple-400 uppercase">Resources</h3>
                        <ul class="space-y-2 text-sm">
                            <li>
                                <a href="/blog/"
                                   class="text-gray-400 transition-colors hover:text-purple-400">Blog</a>
                            </li>
                            <li>
                                <a href="/encyclopedia/"
                                   class="text-gray-400 transition-colors hover:text-purple-400">Encyclopedia</a>
                            </li>
                            <li>
                                <a href="/faq/"
                                   class="text-gray-400 transition-colors hover:text-purple-400">FAQ</a>
                            </li>
                        </ul>
                    </div>
                    <!-- Investing -->
                    <div>
                        <h3 class="mb-4 font-mono text-sm text-purple-400 uppercase">Investing</h3>
                        <ul class="space-y-2 text-sm">
                            <li>
                                <a href="/solutions/"
                                   class="text-gray-400 transition-colors hover:text-purple-400">Solutions</a>
                            </li>
                            <li>
                                <a href="/pricing/"
                                   class="text-gray-400 transition-colors hover:text-purple-400">Pricing</a>
                            </li>
                            <li>
                                <a href="/process/"
                                   class="text-gray-400 transition-colors hover:text-purple-400">Process</a>
                            </li>
                        </ul>
                    </div>
                    <!-- Connect -->
                    <div>
                        <h3 class="mb-4 font-mono text-sm text-purple-400 uppercase">Connect</h3>
                        <ul class="space-y-2 text-sm">
                            <li>
                                <a href="/contact/"
                                   class="text-gray-400 transition-colors hover:text-purple-400">Contact</a>
                            </li>
                            <li>
                                <a href="/newsletter/"
                                   class="text-gray-400 transition-colors hover:text-purple-400">Newsletter</a>
                            </li>
                            <li>
                                <a href="https://linkedin.com/company/ecic"
                                   class="text-gray-400 transition-colors hover:text-purple-400" target="_blank" rel="noopener noreferrer">LinkedIn</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="mt-12 border-t border-gray-600 pt-8 pb-4 text-center">
                    <p class="text-xs text-gray-500">¬© {{ "now"|date:"Y" }} Ethical Capital. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </body>
</html>
