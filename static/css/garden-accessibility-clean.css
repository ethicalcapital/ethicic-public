/*!
 * Garden Accessibility System - Clean Implementation
 * Consolidates all accessibility and contrast fixes for WCAG AA compliance
 * Replaces: accessibility-contrast-fixes.css, wcag-contrast-fixes.css,
 *          strategy-table-contrast-fix.css, table-contrast-accessibility-fix.css
 */

@layer accessibility {
  /* ===== FOUNDATION: COLOR ACCESSIBILITY ===== */

  /* Base text contrast ensuring 4.5:1 ratio minimum */
  :root {
    --accessible-text-primary: var(--color-text-primary);
    --accessible-text-secondary: var(--color-text-secondary);
    --accessible-purple-light: #9b7dd8; /* Lighter purple for dark backgrounds */
    --accessible-purple-dark: var(--color-primary); /* Original purple for light backgrounds */
  }

  /* ===== GENERAL CONTENT ACCESSIBILITY ===== */

  /* Main content areas - ensure proper background/text contrast */
  .hero-panel,
  .garden-panel.hero-panel,
  .main-content {
    background: var(--color-background);
    color: var(--accessible-text-primary);
  }

  /* Muted text elements - maintain readability */
  .garden-muted,
  [class*="muted"],
  .color-text-secondary,
  [class*="text-secondary"] {
    color: var(--accessible-text-primary);
    opacity: 0.85;
    font-weight: var(--font-medium);
  }

  /* ===== STATISTICS AND METRICS ACCESSIBILITY ===== */

  /* Statistical labels and dates */
  .stat-label,
  .stat-label span,
  span.stat-label {
    color: var(--accessible-text-primary);
    font-weight: var(--font-medium);
    opacity: 1;
  }

  .stat-date,
  .stat-date span,
  span.stat-date {
    color: var(--accessible-text-primary);
    opacity: 0.9;
    font-weight: var(--font-medium);
  }

  /* Statistical values - use accessible purple */
  .stat-value,
  .stat-value span,
  .stat-number {
    color: var(--accessible-purple-dark);
    font-weight: var(--font-bold);
  }

  /* ===== TABLE ACCESSIBILITY ===== */

  /* Base table styling for proper contrast */
  .strategy-table,
  .performance-table,
  .geographic-table,
  .allocation-table {
    background: var(--color-surface);
    border: 2px solid var(--color-border);
    border-radius: var(--radius-lg);
    overflow: hidden;
  }

  /* Table headers - purple background with white text */
  .strategy-table .table-header,
  .strategy-table th,
  .performance-table .table-header,
  .performance-table th,
  .geographic-header,
  .allocation-header {
    background: var(--color-primary);
    border-bottom: none;
    padding: 0;
  }

  .strategy-table .header-cell,
  .strategy-table th,
  .performance-table .header-cell,
  .performance-table th,
  .geographic-header > div,
  .allocation-header > div {
    color: var(--garden-color-white, #fff);
    font-weight: var(--font-bold);
    padding: var(--space-4);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-size: var(--font-sm);
    opacity: 1;
    -webkit-text-fill-color: var(--garden-color-white);
  }

  /* Table body and rows */
  .strategy-table tbody,
  .performance-table .table-body {
    background: var(--color-surface);
  }

  .strategy-table tbody tr,
  .performance-table .table-row,
  .geographic-row,
  .allocation-row {
    border-bottom: 1px solid var(--color-border);
    background: var(--color-surface);
  }

  .strategy-table tbody tr:nth-child(even),
  .performance-table .table-row:nth-child(even),
  .geographic-row:nth-child(even),
  .allocation-row:nth-child(even) {
    background: var(--color-surface-variant);
  }

  /* Table cells - ensure proper contrast */
  .strategy-table td,
  .strategy-table .label,
  .performance-table .cell,
  .geographic-row > div,
  .allocation-row > div,
  td.label,
  table .label {
    color: var(--accessible-text-primary);
    font-weight: var(--font-normal);
    padding: var(--space-4);
    font-size: var(--font-base);
    opacity: 1;
    -webkit-text-fill-color: var(--accessible-text-primary);
  }

  /* Special table cells */
  .strategy-table .cell.positive,
  .performance-table .cell.positive {
    color: var(--color-success);
    font-weight: var(--font-semibold);
  }

  .strategy-table .cell.negative,
  .performance-table .cell.negative {
    color: var(--color-error);
    font-weight: var(--font-semibold);
  }

  .total-row {
    background: var(--color-surface-elevated);
    border-top: 2px solid var(--color-primary);
    font-weight: var(--font-bold);
  }

  .benchmark-row {
    background: var(--color-background);
    font-style: italic;
  }

  /* Table alignment */
  .strategy-table .header-cell,
  .strategy-table .table-row > .cell,
  .performance-table .header-cell,
  .performance-table .table-row > .cell {
    text-align: center;
  }

  .strategy-table .header-cell:first-child,
  .strategy-table .table-row > .cell:first-child,
  .performance-table .header-cell:first-child,
  .performance-table .table-row > .cell:first-child {
    text-align: left;
    font-weight: var(--font-medium);
  }

  /* ===== HEADER NAVIGATION ACCESSIBILITY ===== */

  /* Header buttons - ensure proper contrast */
  .garden-header .garden-search-btn,
  .garden-header .garden-login-btn,
  .garden-header .garden-theme-toggle {
    background: transparent;
    color: white;
    border: 1px solid rgb(255 255 255 / 30%);
  }

  .garden-header .garden-search-btn:hover,
  .garden-header .garden-login-btn:hover,
  .garden-header .garden-theme-toggle:hover {
    background: rgb(255 255 255 / 10%);
    border-color: rgb(255 255 255 / 50%);
  }

  /* ===== FOOTER ACCESSIBILITY ===== */

  /* Footer contrast improvements */
  .garden-footer {
    background: var(--color-surface);
    color: var(--accessible-text-primary);
  }

  .garden-footer p,
  .garden-footer-legal,
  .garden-footer-legal p,
  .garden-footer-bottom p,
  [role="contentinfo"] p {
    color: var(--accessible-text-primary);
    opacity: 0.9;
    font-weight: var(--font-normal);
  }

  .garden-footer-link {
    color: var(--accessible-text-primary);
    opacity: 0.85;
  }

  .garden-footer-link:hover {
    color: var(--color-primary);
    opacity: 1;
  }

  .garden-footer-section h3 {
    color: var(--accessible-text-primary);
  }

  /* ===== BANNER AND NOTIFICATION ACCESSIBILITY ===== */

  .accepting-clients-banner {
    background: var(--color-primary);
  }

  .accepting-clients-banner .banner-text strong {
    color: white;
  }

  /* ===== CONTENT-SPECIFIC ACCESSIBILITY ===== */

  /* Hero and highlighting elements */
  .hero-tagline {
    color: var(--accessible-purple-dark);
    font-weight: var(--font-bold);
  }

  .philosophy-highlight {
    color: var(--accessible-purple-dark);
    font-weight: var(--font-semibold);
  }

  /* Content paragraphs and descriptions */
  .principle-content,
  .strategy-features p,
  .strategy-features li,
  .step-content p {
    color: var(--accessible-text-primary);
    opacity: 0.9;
  }

  .disclaimer {
    color: var(--accessible-text-primary);
    opacity: 0.8;
  }

  .cta-info-item {
    color: var(--accessible-text-primary);
  }

  /* ===== BUTTON ACCESSIBILITY ===== */

  /* Ensure proper button contrast */
  .garden-action.primary {
    background: var(--color-primary);
    color: white;
    border: none;
  }

  .garden-action.secondary {
    background: transparent;
    color: var(--accessible-purple-dark);
    border: 2px solid var(--accessible-purple-dark);
  }

  /* ===== FOCUS STATES FOR ACCESSIBILITY ===== */

  /* Table focus states */
  .strategy-table .label:focus,
  .performance-table .cell:focus,
  td.label:focus,
  table .label:focus {
    outline: 2px solid var(--color-primary);
    outline-offset: 2px;
    background: var(--color-primary-alpha-light);
  }

  /* General focus improvements */
  .garden-action:focus-visible,
  .garden-button:focus-visible,
  .garden-nav-item:focus-visible {
    outline: 2px solid var(--color-focus, var(--color-secondary));
    outline-offset: 2px;
  }
}

@layer theme-modes {
  /* ===== LIGHT MODE SPECIFIC ACCESSIBILITY ===== */

  [data-theme="light"] .stat-label,
  [data-theme="light"] .stat-date {
    color: var(--color-text-secondary);
    opacity: 1;
    font-weight: var(--font-medium);
  }

  [data-theme="light"] .stat-value,
  [data-theme="light"] .hero-tagline,
  [data-theme="light"] .philosophy-highlight {
    color: var(--accessible-purple-dark);
  }

  /* Light mode table text */
  [data-theme="light"] .strategy-table .label,
  [data-theme="light"] td.label,
  [data-theme="light"] table .label {
    color: #333;
    -webkit-text-fill-color: #333;
    font-weight: 500;
  }

  [data-theme="light"] .strategy-table td,
  [data-theme="light"] .performance-table .cell {
    color: #111;
    -webkit-text-fill-color: #111;
  }

  /* ===== DARK MODE SPECIFIC ACCESSIBILITY ===== */

  /* Dark mode uses lighter purple for better contrast */
  [data-theme="dark"] a,
  [data-theme="dark"] .policy-link,
  [data-theme="dark"] .process-link,
  [data-theme="dark"] .resource-link {
    color: var(--accessible-purple-light);
  }

  [data-theme="dark"] a:hover,
  [data-theme="dark"] .policy-link:hover,
  [data-theme="dark"] .process-link:hover,
  [data-theme="dark"] .resource-link:hover {
    color: #b19cd9; /* Even lighter on hover */
    text-decoration: underline;
  }

  /* Dark mode headings and primary color elements */
  [data-theme="dark"] .exclusions-section-title,
  [data-theme="dark"] .principles-section-title,
  [data-theme="dark"] h1.text-primary,
  [data-theme="dark"] h2.text-primary,
  [data-theme="dark"] h3.text-primary,
  [data-theme="dark"] h4.text-primary,
  [data-theme="dark"] .text-primary,
  [data-theme="dark"] .stat-value,
  [data-theme="dark"] .stat-number,
  [data-theme="dark"] .hero-tagline,
  [data-theme="dark"] .philosophy-highlight {
    color: var(--accessible-purple-light);
  }

  /* Dark mode content elements */
  [data-theme="dark"] .exclusion-title,
  [data-theme="dark"] .criteria-card h4,
  [data-theme="dark"] .methodology-card h4,
  [data-theme="dark"] .principle-title,
  [data-theme="dark"] .principle-card h4,
  [data-theme="dark"] .strategy-features li::before {
    color: var(--accessible-purple-light);
  }

  /* Dark mode table accessibility */
  [data-theme="dark"] .strategy-table .label,
  [data-theme="dark"] td.label,
  [data-theme="dark"] table .label {
    color: #e0e0e0;
    -webkit-text-fill-color: #e0e0e0;
    font-weight: 500;
  }

  [data-theme="dark"] .strategy-table td,
  [data-theme="dark"] .performance-table .cell,
  [data-theme="dark"] .geographic-row > div,
  [data-theme="dark"] .allocation-row > div {
    color: #f0f0f0;
    -webkit-text-fill-color: #f0f0f0;
  }

  /* Dark mode surface colors for tables */
  [data-theme="dark"] .strategy-page,
  [data-theme="dark"] .performance-table-container {
    --color-surface: var(--theme-surface, var(--color-shadow-80));
    --color-surface-variant: var(--theme-surface-variant, var(--color-shadow-50));
    --color-surface-elevated: var(--color-shadow-40);
  }

  /* Dark mode button accessibility */
  [data-theme="dark"] .garden-action.secondary {
    color: var(--accessible-purple-light);
    border-color: var(--accessible-purple-light);
  }

  [data-theme="dark"] .garden-action.secondary:hover {
    background: rgb(155 125 216 / 10%);
    color: #b19cd9;
    border-color: #b19cd9;
  }

  /* Catch-all for missed purple elements */
  [data-theme="dark"] .color-primary,
  [data-theme="dark"] .text-color-primary,
  [data-theme="dark"] [style*="color: var(--color-primary)"],
  [data-theme="dark"] [style*="#3d2970"],
  [data-theme="dark"] [style*="rgb(61, 41, 112)"] {
    color: var(--accessible-purple-light);
  }
}

@layer enhanced-accessibility {
  /* ===== HIGH CONTRAST MODE SUPPORT ===== */

  @media (prefers-contrast: more) {
    /* Enhanced text contrast */
    .stat-label,
    .stat-date,
    .garden-footer p,
    .garden-footer-legal,
    .garden-muted,
    .principle-content,
    .strategy-features p,
    .step-content p {
      color: var(--accessible-text-primary);
      opacity: 1;
      font-weight: var(--font-medium);
    }

    /* Enhanced border visibility */
    .strategy-table,
    .performance-table,
    .strategy-card,
    .garden-footer {
      border-color: var(--accessible-text-primary);
      border-width: 2px;
    }

    /* Enhanced table accessibility */
    .strategy-table .label,
    .performance-table .cell,
    td.label,
    table .label {
      color: var(--accessible-text-primary);
      font-weight: 600;
      text-shadow: 0 0 1px rgb(0 0 0 / 30%);
    }

    [data-theme="light"] .strategy-table .label,
    [data-theme="light"] td.label,
    [data-theme="light"] table .label {
      color: #000;
      -webkit-text-fill-color: #000;
    }

    [data-theme="dark"] .strategy-table .label,
    [data-theme="dark"] td.label,
    [data-theme="dark"] table .label {
      color: #fff;
      -webkit-text-fill-color: #fff;
    }

    /* Enhanced table headers */
    .strategy-table .table-header,
    .performance-table .table-header,
    .geographic-header,
    .allocation-header {
      background: var(--color-shadow-80);
    }

    .strategy-table .header-cell,
    .performance-table .header-cell,
    .geographic-header > div,
    .allocation-header > div {
      color: var(--garden-color-white, #fff);
      font-weight: 900;
    }

    /* Enhanced table rows */
    .strategy-table tbody tr,
    .performance-table .table-row,
    .geographic-row,
    .allocation-row {
      border: 2px solid var(--accessible-text-primary);
    }
  }

  /* ===== FORCED COLORS MODE (Windows High Contrast) ===== */

  @media (forced-colors: active) {
    /* System color compliance */
    .stat-label,
    .stat-date,
    .garden-footer p,
    .garden-footer-legal,
    .garden-muted,
    .principle-content,
    .strategy-features p,
    .step-content p,
    .strategy-table .label,
    .performance-table .cell,
    td.label,
    table .label {
      color: CanvasText;
      -webkit-text-fill-color: CanvasText;
      opacity: 1;
      forced-color-adjust: none;
    }

    .stat-value,
    .hero-tagline,
    .philosophy-highlight {
      color: Highlight;
      forced-color-adjust: none;
    }

    .garden-footer,
    .hero-panel,
    .strategy-card,
    .strategy-table,
    .performance-table {
      background: Canvas;
      border-color: CanvasText;
      forced-color-adjust: none;
    }

    /* Table headers in forced colors */
    .strategy-table .table-header,
    .performance-table .table-header,
    .geographic-header,
    .allocation-header {
      background: Highlight;
      forced-color-adjust: none;
    }

    .strategy-table .header-cell,
    .performance-table .header-cell,
    .geographic-header > div,
    .allocation-header > div {
      color: HighlightText;
      forced-color-adjust: none;
    }

    /* Table rows in forced colors */
    .strategy-table tbody tr,
    .performance-table .table-row,
    .geographic-row,
    .allocation-row {
      border: 1px solid CanvasText;
      forced-color-adjust: none;
    }

    /* Preserve positive/negative indicators */
    .strategy-table .cell.positive,
    .strategy-table .cell.negative,
    .performance-table .cell.positive,
    .performance-table .cell.negative {
      forced-color-adjust: none;
    }
  }

  /* ===== REDUCED MOTION SUPPORT ===== */

  @media (prefers-reduced-motion: reduce) {
    /* Remove animations from focus states */
    .strategy-table .label:focus,
    .performance-table .cell:focus,
    .garden-action:focus-visible,
    .garden-button:focus-visible {
      transition: none;
    }
  }
}
