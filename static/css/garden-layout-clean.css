/*!
 * Garden Layout System - Clean Implementation
 * Consolidates layout, navigation, and spacing fixes
 */

@layer base {
  /* ===== PAGE STRUCTURE ===== */

  /* Main content constraints */
  .main-content,
  .garden-container {
    max-width: var(--content-width-normal, 1200px);
    margin: 0 auto;
    padding: 0 var(--space-4);
    width: 100%;
  }

  /* Ensure proper containment for all page types */
  .public-site-context .main-content,
  .public-site-context .garden-container,
  .homepage-page .main-content,
  .about-page .main-content,
  .contact-page .main-content,
  .blog-page .main-content {
    max-width: var(--content-width-normal, 1200px);
    margin-left: auto;
    margin-right: auto;
  }

  /* Page sections spacing */
  .garden-panel + .garden-panel {
    margin-top: var(--space-8);
  }

  /* Fix white line spacing issues */
  .garden-panel,
  .garden-section {
    overflow: hidden; /* Prevent margin collapse causing white lines */
  }

  /* ===== HEADER LAYOUT ===== */

  /* Header sizing and spacing */
  .garden-header {
    padding: var(--space-2) var(--space-4);
    min-height: auto;
    overflow: visible;
    position: relative;
    z-index: var(--z-header, 1000);
  }

  /* Header content layout */
  .garden-header-content {
    padding: 0;
    min-height: auto;
    width: 100%;
    max-width: var(--content-width-wide, 1400px);
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: nowrap;
  }

  /* Header navigation layout */
  .garden-nav-left {
    display: flex;
    align-items: center;
    gap: var(--space-6);
    flex: 0 1 auto;
    min-width: 0;
  }

  .garden-nav-right {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    flex: 0 0 auto;
    overflow: visible; /* Allow dropdowns */
  }

  /* Brand/logo area */
  .garden-brand {
    flex: 0 0 auto;
    font-size: var(--font-xl);
    font-weight: var(--font-bold);
    text-decoration: none;
  }

  /* ===== NAVIGATION LAYOUT ===== */

  /* Desktop navigation */
  .desktop-nav {
    display: flex;
    align-items: center;
    gap: var(--space-5);
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .garden-nav-item {
    display: flex;
    align-items: center;
    white-space: nowrap;
  }

  /* Mobile navigation */
  .mobile-nav {
    display: none; /* Hidden by default, shown via JS */
    position: fixed;
    top: 100%;
    left: 0;
    right: 0;
    background: var(--color-surface);
    border-top: 1px solid var(--color-border);
    z-index: var(--z-mobile-nav, 999);
    max-height: calc(100vh - 100%);
    overflow-y: auto;
  }

  .mobile-nav.open {
    display: block;
  }

  /* Mobile menu toggle */
  .mobile-menu-toggle {
    display: none;
    flex-direction: column;
    justify-content: center;
    width: 24px;
    height: 24px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
  }

  .mobile-menu-toggle span {
    display: block;
    width: 100%;
    height: 2px;
    background: currentcolor;
    margin: 2px 0;
    transition: all var(--duration-fast) var(--ease-out);
  }

  /* ===== RESPONSIVE BREAKPOINTS ===== */

  /* Tablet and below */
  @media (width <= 1024px) {
    .garden-container,
    .main-content {
      max-width: none;
      padding: 0 var(--space-3);
    }

    .garden-header-content {
      max-width: none;
      padding: 0 var(--space-3);
    }
  }

  /* Mobile */
  @media (width <= 768px) {
    .desktop-nav {
      display: none;
    }

    .mobile-menu-toggle {
      display: flex;
    }

    .garden-nav-left {
      gap: var(--space-4);
    }

    .garden-nav-right {
      gap: var(--space-2);
    }

    .garden-header {
      padding: var(--space-2) var(--space-3);
    }

    .garden-container,
    .main-content {
      padding: 0 var(--space-3);
    }

    /* Mobile nav spacing */
    .mobile-nav {
      padding: var(--space-4);
    }

    .mobile-nav .garden-nav-item {
      padding: var(--space-3) 0;
      border-bottom: 1px solid var(--color-border);
    }
  }

  /* Small mobile */
  @media (width <= 480px) {
    .garden-header {
      padding: var(--space-2);
    }

    .garden-container,
    .main-content {
      padding: 0 var(--space-2);
    }

    .garden-nav-left {
      gap: var(--space-3);
    }

    .garden-brand {
      font-size: var(--font-lg);
    }
  }

  /* ===== LAYOUT UTILITIES ===== */

  /* Flex layouts */
  .garden-flex {
    display: flex;
    gap: var(--space-4);
  }

  .garden-flex.center {
    align-items: center;
    justify-content: center;
  }

  .garden-flex.between {
    justify-content: space-between;
  }

  .garden-flex.wrap {
    flex-wrap: wrap;
  }

  /* Grid layouts */
  .garden-grid {
    display: grid;
    gap: var(--space-4);
  }

  .garden-grid.cols-2 {
    grid-template-columns: repeat(2, 1fr);
  }

  .garden-grid.cols-3 {
    grid-template-columns: repeat(3, 1fr);
  }

  .garden-grid.cols-auto {
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  }

  /* Container utilities */
  .garden-container.narrow {
    max-width: var(--content-width-narrow, 800px);
  }

  .garden-container.wide {
    max-width: var(--content-width-wide, 1400px);
  }

  .garden-container.full {
    max-width: none;
  }

  /* Spacing utilities */
  .garden-section {
    padding: var(--space-12) 0;
  }

  .garden-section.compact {
    padding: var(--space-8) 0;
  }

  .garden-section.spacious {
    padding: var(--space-16) 0;
  }
}

@layer utilities {
  /* ===== EMERGENCY LAYOUT FIXES ===== */

  /* Force proper header layout when needed */
  .force-header-layout .garden-header {
    padding: var(--space-2) var(--space-4);
    min-height: auto;
    overflow: visible;
  }

  /* Force content width constraints */
  .force-content-width {
    max-width: var(--content-width-normal, 1200px);
    margin-left: auto;
    margin-right: auto;
  }

  /* Fix layout spacing issues */
  .fix-white-lines {
    overflow: hidden;
  }

  .fix-white-lines > * {
    margin-top: 0;
    margin-bottom: 0;
  }

  /* Mobile navigation fixes */
  .force-mobile-nav-hide {
    display: none;
  }

  @media (width <= 768px) {
    .force-mobile-nav-show {
      display: block;
    }
  }
}
